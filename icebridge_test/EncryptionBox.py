

class EncryptionBox():
    def __init__(self):
        self.Stable = [
            3,59,133,189,98,90,228,220,31,39,153,161,126,70,248,192,
			193,249,71,127,160,152,38,30,221,229,91,99,188,132,58,2,
			42,18,172,148,75,115,205,245,54,14,176,136,87,111,209,233,
			232,208,110,86,137,177,15,55,244,204,114,74,149,173,19,43,
			151,175,17,41,246,206,112,72,139,179,13,53,234,210,108,84,
			85,109,211,235,52,12,178,138,73,113,207,247,40,16,174,150,
			190,134,56,0,223,231,89,97,162,154,36,28,195,251,69,125,
			124,68,250,194,29,37,155,163,96,88,230,222,1,57,135,191,
			64,120,198,254,33,25,167,159,92,100,218,226,61,5,187,131,
			130,186,4,60,227,219,101,93,158,166,24,32,255,199,121,65,
			105,81,239,215,8,48,142,182,117,77,243,203,20,44,146,170,
			171,147,45,21,202,242,76,116,183,143,49,9,214,238,80,104,
			212,236,82,106,181,141,51,11,200,240,78,118,169,145,47,23,
			22,46,144,168,119,79,241,201,10,50,140,180,107,83,237,213,
			253,197,123,67,156,164,26,34,225,217,103,95,128,184,6,62,
			63,7,185,129,94,102,216,224,35,27,165,157,66,122,196,252
        ]

    def SwitchSbox(self, s, t):
        sIndex = 0
        tIndex = 0
        if s == t:
            return
        for i in range(256):
            if s == self.Stable[i]:
                sIndex = i
            if t == self.Stable[i]:
                tIndex = i
        tmp = self.Stable[sIndex]
        self.Stable[sIndex] = self.Stable[tIndex]
        self.Stable[tIndex] = tmp

    def SwithTable(self, interChanges):
        if len(interChanges) != 128:
            return
        i = 0
        while i < 128:
            self.SwitchSbox(ord(interChanges[i]),ord(interChanges[i+1]));
            i += 2

    def EDcrpt(self, buff, size):
        ret = ""
        for i in range(size):
            ret += chr(self.Stable[ord(buff[i])])
        return ret




